<div class="quiz-form-container">
  <mat-card class="form-card">
    <mat-card-header>
      <mat-icon class="icon">edit_note</mat-icon>
      <mat-card-title>โ๏ธ ุงุฌุงุฏ / ูุฑุงุด ุขุฒููู</mat-card-title>
    </mat-card-header>

    <mat-card-content>
      <form [formGroup]="form" (ngSubmit)="saveQuiz()" class="quiz-form">
        <div class="form-row">
          <mat-form-field appearance="outline" class="full">
            <mat-label>ุนููุงู ุขุฒููู</mat-label>
            <input matInput formControlName="title" placeholder="ูุซูุงู ุขุฒููู ุฑุงุถ ูพุงู ต" />
          </mat-form-field>
        </div>

        <div class="form-row two-cols">
          <mat-form-field appearance="outline">
            <mat-label>ูุฏุช ุขุฒููู (ุฏููู)</mat-label>
            <input matInput type="number" formControlName="durationMinutes" min="1" />
          </mat-form-field>

          <mat-form-field appearance="outline">
            <mat-label>ุชุงุฑุฎ ุงููุถุง</mat-label>
            <input matInput type="datetime-local" formControlName="expirationDate" />
          </mat-form-field>
        </div>

        <h3 class="section-title">๐งฉ ุงูุชุฎุงุจ ุณูุงูุงุช</h3>

        @if(isLoading){
          <div class="loading">
            <mat-progress-bar mode="indeterminate"></mat-progress-bar>
            <p>ุฏุฑ ุญุงู ุจุงุฑฺฏุฐุงุฑ ุณูุงูุงุช...</p>
          </div>
        }
        @else if(!questions.length){
          <div class="empty-state">
            <mat-icon>question_mark</mat-icon>
            <p>ูููุฒ ูฺ ุณูุงู ุซุจุช ูุดุฏู ุงุณุช.</p>
          </div>
        }
        @else{
          <div class="questions-grid">
            @for(q of questions; track q.id)
            {
              <mat-card class="question-card" [class.selected]="selected.includes(q.id)" (click)="toggleSelect(q.id)" onkeypress="toggleSelect(q.id)" >
                <mat-card-title>{{ q.text }}</mat-card-title>
                <mat-card-content>
                  <ul>
                    @for(a of q.answers; track a.id){
                      <li [class.correct]="a.isCorrect">{{ a.text }}</li>
                    }
                  </ul>
                </mat-card-content>
              </mat-card>
            }
          </div>
        }

        <div class="actions">
          <button mat-raised-button color="primary" type="submit" class="save-btn">
            ๐พ ุฐุฎุฑู ุขุฒููู
          </button>
          <button mat-stroked-button color="accent" type="button" (click)="cancel()">
            ุงูุตุฑุงู
          </button>
        </div>
      </form>
    </mat-card-content>
  </mat-card>
</div>
